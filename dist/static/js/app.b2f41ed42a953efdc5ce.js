webpackJsonp([1,2],{38:function(t,o,n){"use strict";var i=n(37),e=n.n(i),s={};s.randomBomb=function(t,o){console.time("random"),console.log(t,o),t>o&&(t=o);var n=Array(o).fill(!1),i=Array(t).fill(1).map(function t(){var i=~~(Math.random()*o);return n[i]?t():(n[i]=!0,i)});console.log(i);var s=new e.a;return i.forEach(function(t){return s.add(t)}),console.timeEnd("random"),s},s.getCellStatus=function(t,o){return o.isFlag?t.isFlag:0===o.status?t.status0:o.isBomb?t.isBomb:o.bombCount>0?t.bombCount+o.bombCount:t.bombCount0},o.a=s},39:function(t,o,n){n(48);var i=n(14)(n(92),n(43),null,null);t.exports=i.exports},41:function(t,o,n){var i=n(14)(n(93),n(45),null,null);t.exports=i.exports},42:function(t,o,n){n(50),n(49);var i=n(14)(n(94),n(44),"data-v-75f32dd9",null);t.exports=i.exports},43:function(t,o){t.exports={render:function(){var t=this,o=t.$createElement,n=t._self._c||o;return n("div",{attrs:{id:"app"}},[n("game")],1)},staticRenderFns:[]}},44:function(t,o){t.exports={render:function(){var t=this,o=t.$createElement,n=t._self._c||o;return n("div",{class:t.config.theme},[n("vue-drr",{staticClass:"scoreboard",attrs:{w:180,h:180,r:0,resizeable:!1,rotatable:!1}},[n("h3",[t._v("计分板")]),t._v("\n    旗帜数量： "+t._s(t.flagCount)+" "),n("br"),n("br"),t._v("\n    分数： "+t._s(t.score)+"\n  ")]),t._v(" "),n("div",{staticClass:"game-config"},[n("form",{attrs:{action:""},on:{submit:function(o){o.preventDefault(),t.init(o)}}},[n("label",[t._v("行: "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.inputRow,expression:"inputRow"}],attrs:{type:"number"},domProps:{value:t.inputRow},on:{input:function(o){o.target.composing||(t.inputRow=o.target.value)},blur:function(o){t.$forceUpdate()}}})]),t._v(" "),n("label",[t._v("列: "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.inputCol,expression:"inputCol"}],attrs:{type:"number"},domProps:{value:t.inputCol},on:{input:function(o){o.target.composing||(t.inputCol=o.target.value)},blur:function(o){t.$forceUpdate()}}})]),t._v(" "),n("label",[t._v("雷的数量: "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.inputBombCount,expression:"inputBombCount"}],attrs:{type:"number"},domProps:{value:t.inputBombCount},on:{input:function(o){o.target.composing||(t.inputBombCount=o.target.value)},blur:function(o){t.$forceUpdate()}}})]),t._v(" "),n("button",{attrs:{type:"submit"}},[t._v("生成")])]),t._v(" "),t.showTips?n("div",{staticClass:"game-config-tips"},[t._v(t._s(t.tipsText))]):t._e()]),t._v(" "),n("table",{staticClass:"game",class:{"tips-open":t.showTips},attrs:{width:t.width},on:{mouseup:t.handleClick,contextmenu:function(o){o.preventDefault(),t.handleRightClick(o)}}},t._l(t.cellData,function(o,i){return n("tr",{key:i},t._l(o,function(t,o){return n("cell",{key:o,attrs:{row:t.row,col:t.col,isBomb:t.isBomb,status:t.status,isFlag:t.isFlag,bombCount:t.bombCount}})}))})),t._v(" "),t.gameOver?n("div",{staticClass:"gameover layer"},[n("div",[t._v("Game Over")]),t._v(" "),n("div",[t._v("你美丽了!")]),t._v(" "),n("div",{staticClass:"retry"},[n("a",{attrs:{href:"#"},on:{click:function(o){o.preventDefault(),t.init(o)}}},[t._v("再试一次")])])]):t._e(),t._v(" "),t.success?n("div",{staticClass:"success layer"},[n("div",[t._v("Win!")]),t._v(" "),n("div",[t._v("你成功了!")]),t._v(" "),n("div",{staticClass:"retry"},[n("a",{attrs:{href:"#"},on:{click:function(o){o.preventDefault(),t.init(o)}}},[t._v("我还要玩")])])]):t._e()],1)},staticRenderFns:[]}},45:function(t,o){t.exports={render:function(){var t=this,o=t.$createElement;return(t._self._c||o)("td",{class:t.className},[t._v(t._s(t.display))])},staticRenderFns:[]}},48:function(t,o){},49:function(t,o){},50:function(t,o){},91:function(t,o,n){"use strict";o.a={bombCount:50,row:20,col:20,maxRow:100,maxCol:100,theme:"classic"}},92:function(t,o,n){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=n(42),e=n.n(i);o.default={name:"app",components:{game:e.a}}},93:function(t,o,n){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=n(38);o.default={name:"cell",props:["row","col","isBomb","status","isFlag","bombCount"],computed:{display:function(){return i.a.getCellStatus({isFlag:"",status0:"",isBomb:"雷",bombCount:"",bombCount0:""},this)},className:function(){return i.a.getCellStatus({isFlag:"flag fa-flag",status0:"status0",isBomb:"bomb",bombCount:"bomb-count-",bombCount0:"bomb-count-0"},this)}}}},94:function(t,o,n){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=n(37),e=n.n(i),s=n(90),a=n.n(s),u=n(41),r=n.n(u),c=n(91),l=n(38),f=n(47),m=n.n(f);o.default={name:"game",components:{cell:r.a,"vue-drr":m.a},data:function(){return{config:a()({},c.a),gameOver:!1,cellData:[],showTips:!1,width:0,flagCount:0,score:0,inputRow:c.a.row,inputCol:c.a.col,inputBombCount:c.a.bombCount,bombSet:new e.a,success:!1,tipsText:""}},mounted:function(){this.init()},computed:{cellCount:function(){return this.config.col*this.config.row}},watch:{score:function(t){if(t===this.cellCount-this.config.bombCount){var o=this;this.bombSet.forEach(function(t){var n=t%o.config.col,i=~~(t/o.config.col);console.log(n,i),o.cellData[i][n].isFlag=1}),this.$forceUpdate(),this.score=this.cellCount,this.flagCount=this.config.bombCount,this.success=!0}}},methods:{init:function(){return~~this.inputCol>this.config.maxCol||~~this.inputRow>this.config.maxRow?(this.tipsText="请勿作死设置过大行列！",this.showTips=!0,this.inputRow=this.config.row,this.inputCol=this.config.col,void(this.inputBombCount=this.config.bombCount)):(this.config.col=~~this.inputCol,this.config.row=~~this.inputRow,~~this.inputBombCount>=this.cellCount?(this.tipsText="雷的数量最大为格子数量减1",this.showTips=!0,void(this.inputBombCount=this.cellCount-1)):(this.config.bombCount=~~this.inputBombCount,this.showTips=!1,this.success=!1,this.gameOver=!1,this.score=0,this.flagCount=0,this.width=41*this.config.col+1,void(this.cellData=this.initData())))},initData:function(){var t=this;this.bombSet=l.a.randomBomb(this.config.bombCount,this.config.col*this.config.row);var o=[];return console.time("map"),o=Array(this.config.row).fill(0).map(function(o,n){return Array(t.config.col).fill(0).map(function(o,i){return{status:0,isFlag:!1,row:n,col:i,isBomb:t.bombSet.has(n*t.config.col+i),bombCount:0,isTriggered:!1}})}),console.timeEnd("map"),o},fail:function(){this.gameOver=!0},handleClick:function(t){if("TD"===t.target.nodeName){var o=t.target.cellIndex,n=t.target.parentNode.rowIndex,i=this.cellData[n][o];if(0===i.status){var e=t.button;if(0===e){if(!i.isFlag){if(i.status=1,i.isBomb)return this.$forceUpdate(),void this.fail();this.score++;var s=this.getAroundCell(n,o);if(i.bombCount=s.reduce(function(t,o){return t+(o.isBomb?1:0)},0),0===i.bombCount){var a=this.$el.querySelector("table"),u=this.$nextTick;i.isTriggered=!0,s.forEach(function(t){if(!t.isTriggered&&!t.isFlag&&1!==t.status){var o=new MouseEvent("mouseup",{button:0,bubbles:!0});u(function(){a.rows[t.row].cells[t.col].dispatchEvent(o)})}})}this.$forceUpdate()}}else 2===e&&(i.isFlag?(this.flagCount--,i.isFlag=!1):(this.flagCount++,i.isFlag=!0),this.$forceUpdate())}}},handleRightClick:function(){},getAroundCell:function(t,o){var n=[t-1,t,t+1],i=[o-1,o,o+1],e=[],s=this;return n.forEach(function(n){i.forEach(function(i){n===t&&i===o||n<0||n>=s.config.row||i<0||i>=s.config.col||e.push(s.cellData[n][i])})}),e}}}},95:function(t,o,n){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=n(40),e=n(39),s=n.n(e);i.a.config.productionTip=!1,new i.a({el:"#app",render:function(t){return t(s.a)}})}},[95]);
//# sourceMappingURL=app.b2f41ed42a953efdc5ce.js.map